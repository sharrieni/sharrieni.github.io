<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>meow</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap" rel="stylesheet">
<style>
  body {
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #fdf6f9;
    font-family: 'Inter', sans-serif;
    overflow: hidden;
  }

  // what the fuck are these things for??
  .game-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: opacity 0.6s ease;
  }

  .grid {
    width: calc(5*60px + 4*4px);
    height: calc(5*60px + 4*4px);
    display: inline-grid;
    grid-template-columns: repeat(5, 60px);
    grid-template-rows: repeat(5, 60px);
    gap: 4px;
    position: relative;
    background: #ffe6ec;
    border-radius: 12px;
    transition: opacity 0.6s ease;
  }

  .tile {
    width: 60px;
    height: 60px;
    background: #ffd9e0;
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    font-size: 1.5rem;
    user-select: none;
  }

  .tile:hover {
    background: #ffb8d2;
  }

  .character {
    position: absolute;
    font-size: 1.5rem;
    pointer-events: none;
    transition: top 0.3s, left 0.3s, opacity 0.6s;
    z-index: 2;
  }

  .message-box {
    margin-top: 20px;
    font-size: 1.2rem;
    color: #d66a87;
    text-align: center;
    opacity: 0;
    transition: opacity 0.5s;
  }

  .message-box.show {
    opacity: 1;
  }

  .snowflake {
    position: absolute;
    top: -10px;
    color: #ffb8d2cc;
    font-size: 1rem;
    user-select: none;
    animation: fall linear infinite;
    opacity: 0.9;
  }

  @keyframes fall {
    to { transform: translateY(110vh) rotate(360deg); }
  }

  .final-screen {
    position: fixed;
    inset: 0;
    background: #fde7ef;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 1.5s ease;
    font-family: 'Inter', sans-serif;
    padding: 20px;
  }

  .final-screen.show {
    opacity: 1;
    pointer-events: all;
  }

  .final-letter {
    background: #ffdae6;
    padding: 40px 50px;
    border-radius: 16px;
    max-width: 480px;
    animation: pop 1s ease;
  }

  .final-letter h1 {
    font-size: 2rem;
    color: #d95f86;
    margin-bottom: 10px;
  }

  .final-letter p {
    font-size: 1.2rem;
    color: #b14567;
    line-height: 1.6;
  }

  @keyframes pop {
    0% { transform: scale(0.8); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
  }
</style>
</head>
<body>

<div class="game-container" id="gameContainer">
  <div class="grid" id="grid"></div>
  <div class="message-box" id="message">i hate coding, but i love you <3</div>
</div>

<div id="finalScreen" class="final-screen">
  <div class="final-letter">
    <h1>for you, my love</h1>
    <p>
      thank you for sharing the holiday with me.<br>
      i'm glad it's you above all,<br>
      and i'm very proud to be your girlfriend.<br>
      i love you more than you know.
    </p>
  </div>
</div>

<script>
  const grid = document.getElementById("grid");
  const message = document.getElementById("message");
  const gameContainer = document.getElementById("gameContainer");

  const rows = 5;
  const cols = 5;

  const bombsPerLevel = [2, 3, 4];  // you can change these

  const levelMessages = [
    "i hate coding, but i love you <3",
    "always my favorite person :)",
    "careful w my tv tho"
  ];

  let currentLevel = 0;
  let charPos = { row: 0, col: 0 };
  let bombMap = [];

  const character = document.createElement("div");
  character.className = "character";
  character.innerHTML = "üêà‚Äç‚¨õ";
  grid.appendChild(character);

  const tiles = [];
  for (let r = 0; r < rows; r++) {
    tiles[r] = [];
    for (let c = 0; c < cols; c++) {
      const tile = document.createElement("div");
      tile.className = "tile";
      tile.addEventListener("click", () => tryMove(r, c));
      grid.appendChild(tile);
      tiles[r][c] = tile;
    }
  }

  function getRandomTile(excluded = []) {
    let r, c;
    do {
      r = Math.floor(Math.random() * rows);
      c = Math.floor(Math.random() * cols);
    } while (excluded.some(e => e.row === r && e.col === c));
    return { row: r, col: c };
  }

  function tryMove(row, col) {
    const rowDiff = Math.abs(row - charPos.row);
    const colDiff = Math.abs(col - charPos.col);

    if ((rowDiff === 1 && colDiff === 0) || (rowDiff === 0 && colDiff === 1)) {
      moveCharacter(row, col);
    }
  }

  function moveCharacter(row, col) {
    if (bombMap[row][col]) {
      tiles[row][col].innerHTML = "üí£";

      message.innerHTML = "elliot is dead. restarting level...";
      message.classList.add("show");

      setTimeout(() => {
        message.classList.remove("show");
        setupLevel(currentLevel);
      }, 1500);

      return;
    }

    charPos = { row, col };
    const tile = tiles[row][col];

    const top = tile.offsetTop + tile.offsetHeight/2 - character.offsetHeight/2;
    const left = tile.offsetLeft + tile.offsetWidth/2 - character.offsetWidth/2;
    character.style.top = top + "px";
    character.style.left = left + "px";

    const pawPos = currentPaw;
    const levelMsg = levelMessages[currentLevel];

    if (row === pawPos.row && col === pawPos.col) {
      message.innerHTML = levelMsg;
      message.classList.add("show");

      setTimeout(() => {
        message.classList.remove("show");
        currentLevel++;

        if (currentLevel < levelMessages.length) {
          setupLevel(currentLevel);
        } else {
          showFinalScreen();
        }
      }, 2500);
    }
  }

  let currentPaw = null;

  function setupLevel(levelIndex) {
    for (let r = 0; r < rows; r++) {
      for (let c = 0; c < cols; c++) {
        tiles[r][c].innerHTML = "";
      }
    }

    bombMap = Array.from({ length: rows }, () => Array(cols).fill(false));

    currentPaw = getRandomTile([{ row: 0, col: 0 }]);

    tiles[currentPaw.row][currentPaw.col].innerHTML = "üêæ";

    const bombsNeeded = bombsPerLevel[levelIndex];
    let used = [{ row: 0, col: 0 }, currentPaw];

    for (let i = 0; i < bombsNeeded; i++) {
      const bombPos = getRandomTile(used);
      used.push(bombPos);
      bombMap[bombPos.row][bombPos.col] = true;
    }

    charPos = { row: 0, col: 0 };
    moveCharacter(0, 0);
  }

  function showFinalScreen() {
    gameContainer.style.opacity = "0";

    const fs = document.getElementById("finalScreen");
    setTimeout(() => {
      fs.classList.add("show");
    }, 700);
  }

  document.addEventListener("keydown", (e) => {
    let newRow = charPos.row;
    let newCol = charPos.col;

    switch (e.key) {
      case "ArrowUp": newRow = Math.max(0, charPos.row - 1); break;
      case "ArrowDown": newRow = Math.min(rows - 1, charPos.row + 1); break;
      case "ArrowLeft": newCol = Math.max(0, charPos.col - 1); break;
      case "ArrowRight": newCol = Math.min(cols - 1, charPos.col + 1); break;
      default: return;
    }

    moveCharacter(newRow, newCol);
  });

  setupLevel(currentLevel);

  const snowflakeCount = 40;
  for (let i = 0; i < snowflakeCount; i++) {
    const flake = document.createElement("div");
    flake.className = "snowflake";
    flake.innerHTML = "‚ùÑ";
    flake.style.left = Math.random() * 100 + "vw";
    flake.style.animationDuration = (4 + Math.random() * 6) + "s";
    flake.style.fontSize = (12 + Math.random() * 10) + "px";
    flake.style.opacity = 0.6 + Math.random() * 0.4;
    document.body.appendChild(flake);
  }
</script>

</body>
</html>
